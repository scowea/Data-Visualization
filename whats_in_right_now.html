<!DOCTYPE html>
<html>
  <head>
  	
  	<meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" type="image/x-icon" href="docs-assetts/favicon.ico" />
    <link rel="shortcut icon" href="http://webapp.sinkspots.org/docs-assets/favicon.ico">
    <link rel="stylesheet" href="http://js.arcgis.com/3.8/js/esri/css/esri.css">
    <title>SinkSpots Mobile</title>
    <link rel="stylesheet" href="http://js.arcgis.com/3.8/js/dojo/dijit/themes/claro/claro.css">
    <link rel="stylesheet" href="http://js.arcgis.com/3.8/js/esri/css/esri.css">
    <link rel="stylesheet" href="css/layout.css">
	
    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.css" rel="stylesheet">


    <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
	
  	<script src="js/bootstrap.min.js"></script>
    <script src="http://js.arcgis.com/3.8/"></script>
       
    <script type="text/javascript" src="js/jquery.slimscroll.min.js"></script>
   
    <script>
//----------------------------------------------------------------------------------- 
// these settings are to allow cross domain requests, such as the .getJSON below...
$(document).bind("mobileinit",  function() {
	
	$.mobile.allowCrossDomainPages = true;
	$.support.cors = true;
	
	// this should show a loading 
	$.mobile.loader.prototype.options.text = "loading";
  	$.mobile.loader.prototype.options.textVisible = true;
  	$.mobile.loader.prototype.options.theme = "a";
  	$.mobile.loader.prototype.options.html = "";
});    	

// .........................................................
// this resizes the table of data so it fits the whole page	
//$(function() {  
//   var window_height = $(window).height();
//   var header_height =  $('.navbar').height();
//   var content_height = window_height - header_height;
//   $('.mygrid-wrapper-div').height(content_height);
//});

//$( window ).resize(function() {
//   var window_height = $(window).height();
//   var header_height =  $('.navbar').height();
//   var content_height = window_height - header_height;
//   $('.mygrid-wrapper-div').height(content_height);
//});

//................................................................................
$(function(){
	$('#slimscroll').slimScroll({
    	//color: '#00f',
    	size: '14px',
    	height: 'auto',
    	alwaysVisible: true
	});
});

//-----------------------------------------------------------------------------------        	
//$( document ).ready(  function() {
//$('#whats_in').live('pageshow', function(event) {
//$(document).bind( "pagebeforechange", function( e, data ) {		
	//$.getJSON('http://webapp.sinkspots.org/services/get_whats_in.php', function(data) {
	
	$.getJSON('services/get_whats_in.php', function(data) {
	
    	//declare a variable with which to build our output (it's best to buffer output and only do one append at the end since DOM manipulation is CPU expensive)
    	var output = '';

		output += '<a class="list-group-item active">All river flow data pulled from USGS...</a>';
		
    	//iterate through the data 
    	$.each(data, function(index, value){
			
        	//add each value to the output buffer
        	//output += '<a href="whats_in_right_now.html#" class="list-group-item">'+value.name.trim()+'<font color=green>'+value.current_flow.trim()+'</font>'+'</a>';
        	if (value.current_flow.trim() == '')
        		output += '<a href="whats_in_right_now.html#" class="list-group-item">'+value.name.trim()+'</a>';
        	else
        		output += '<a href="whats_in_right_now.html#" class="list-group-item">'+value.name.trim()+' [<font color='+value.color.trim()+'>'+value.current_flow.trim()+'</font>]'+'</a>';
        	//output += '<li class="list-group-item"><a href="whats_in_right_now.html#">'+value.name.trim()+'<div align=right><font color=green>'+value.current_flow.trim()+'</font></div>'+'</a></li>';
    		//result.push('<li class="list-group-item"><a href="whats_in_right_now.html#">'+value.name.trim()+'<div align=right><font color=green>'+value.current_flow.trim()+'</font></div>'+'</a></li>');
    	});

    	//now append the buffered output to the listview and either refresh the listview or create it (meaning have jQuery Mobile style the list)    
       $('#mydata').append(output);//or if the listview has yet to be initialized, use `.trigger('create');` instead of `.listview('refresh');`
	}); // end $.getJSON('services/get_whats_in.php', function(data) {
			
//}); // end $( document ).ready(  function() {
	
	

 </script>
  </head>

<body >
  	
<div class="mygrid-wrapper-div">
	<div id="slimscroll">	
   		<div class="list-group"  id="mydata"></div>
	</div>   
</div>
  	
   <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="index.html">SinkSpots</a>
        </div> <!-- /navbar-header -->
        
        <div class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
          	<li ><a href="index.html">Explore!</a></li>
            <li class="active"><a href="whats_in_right_now.html">What's In Right Now?</a></li>
          </ul>
        </div><!--/.nav-collapse -->
        
      </div> <!-- / container -->
    </div> <!-- <div class="navbar navbar-inverse navbar-fixed-top" role="navigation"> -->

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
  
  </body>
</html>