<!DOCTYPE html>
<!-- 
Author: Scott M Weaver
Date: 2014-02-01	
-->
<html>
	<head>
  		<title>Data Visualization</title>
  		<meta charset="utf-8">
    	<meta http-equiv="X-UA-Compatible" content="IE=edge">
    	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    	<meta name="viewport" content="width=device-width, initial-scale=1.0">
    	<link rel="icon" type="image/x-icon" href="favicon.ico" />
    	
    	<!-- Bootstrap core CSS -->
 		<link href="css/bootstrap.min.css" rel="stylesheet">
    	<link href="css/jumbotron.css" rel="stylesheet">

 		<script src="js/jquery.min.js"></script>
		<script src="highcharts/js/highcharts.js"></script>

<script>
//#########################################################################
count = 0;
count_arr = new Array();
x_axis_label = '';

count_2006 = 0;
count_2007 = 0;
count_2008 = 0;
count_2009 = 0;
count_2010 = 0;
count_2011 = 0;
count_2012 = 0;
count_2013 = 0;
count_2014 = 0;

percentage_loaded = 0;
num_photos = 0;
num_photo_pages = 0;
arr_photos = new Array();
apiurl = "http://api.flickr.com/services/rest/?method=flickr.photos.search&format=json&jsoncallback=?&api_key=dd4eb2f7ebff37400f01aae57493f41e&tags=obama,hope&tag_mode=all&extras=date_taken&sort=date-taken-asc";
//Key:dd4eb2f7ebff37400f01aae57493f41e
//Secret:7a6541283f6e96bf
//sort=date-posted-asc (the default value), date-posted-desc, date-taken-asc, date-taken-desc
//Important Dates:
//   Obama elected: 2008-11-4 (november 4, 2008)

// &has_geo=1 
// &sort=date-taken-asc
    
$(document).ready(function(){
        
    // get the data from flickr
    // see how many pages of photos we have...
    $.getJSON(apiurl,function(json){
    	
    	//$("#flickr_data").html('<p>Number of Photo Pages:'+json.photos.pages+'</p>');
    	$("#flickr_count").html('<p>Loading Photos: '+count+'</p>');
    	$("#loading_progressbar").html(percentage_loaded); 
	    
	    total_flickr_photos = json.photos.total;
	    
	    // roll through the pages of photos...
	    for (var this_page=1;this_page<=json.photos.pages;this_page++)
	    {
	    	// get data for this page of photos
	    	$.getJSON(apiurl+'&page='+this_page,function(json){
	    		
	    		//$("#flickr_data").html('<p>Number of Photo Pages:'+json.photos.pages+'</p>');
	    		
	    		$.each(json.photos.photo,function(i,this_photo){
					count++;
					$("#flickr_data").append(count + ': '+ this_photo.datetaken+';'+this_photo.longitude+','+this_photo.latitude+'|');
					$("#flickr_count").html('<p>Loading Photos From Flickr.com tagged with "Hope" and "Obama": <b>'+count+'</b></p>');					
					$("#status_message").html('<h2>One Moment Please...</h2>');
					//var d = new Date(this_photo.datetaken );
					//y = d.getFullYear();
					
				
					// datetaken: 2008-10-29 16:42:07
					var year = this_photo.datetaken.substr(0,4);
					var month = this_photo.datetaken.substr(5,2);
					//window.alert("year of current photo=|" + month+ '|');	
				
					//count_arr[year][month]= count_arr[year][month] + 1;
					//count_arr[year][month]= count_arr[year][month] + 1;
					
					// [Date.UTC(2010,01,01), 29.9],
                	//[Date.UTC(2010,02,02), 71.5],
                	//[Date.UTC(2010,04,03), 106.4],
                	//[Date.UTC(2010,08,06), 129.2],
            
					if (count == 1)
						x_axis_label = "'" + this_photo.datetaken.substr(0,10) + "'";
					else
						x_axis_label = "'" + x_axis_label + "','" + this_photo.datetaken.substr(0,10) + "'";
						
					if (year === "2006")
						count_2006++;  
					  
					// calculate the progress bar percentage
					var progress_bar = document.getElementById('progress-bar');
					percentage_loaded = (count * 100)/total_flickr_photos;
					progress_bar.style.width = percentage_loaded+'%';
					
					// show the ending total count
	    			if (count >= (total_flickr_photos-250))
	    			{
	    				$("#status_message").html(''); // clear the status message
						$("#flickr_count").html('<p>Photos Loaded: <b>'+total_flickr_photos+'</b></p>');
						progress_bar.style.width = '100%';
						
						// we are done so hide the progress bar
						var progress_bar_container = document.getElementById('progress');
						progress_bar_container.style.visibility="hidden";
					} // end if (count >= (total_flickr_photos-250))	  					
				}); // end $.each(json.photos.photo,function(i,myresult){
							
	    	}); // end $.getJSON(apiurl,function(json){    
	    		
	     } // end for (var this_page=1;this_page<=num_photo_pages;this_page++)

	 }); // end $.getJSON(apiurl,function(json){
	
	$(window).load(function() {
		
		// load the bar chart for visual example
		 $('#chart1').highcharts({
            title: {
                text: 'Monthly Count of Flickr.com Photos Tagged with "Hope" and "Obama"',
                x: -20 //center
            },
            subtitle: {
                text: 'Source: Flickr.com',
                x: -20
            },
            xAxis: {
               
            	type: 'datetime'
        
            },
            yAxis: {
                title: {
                    text: 'Count By Month'
                },
                plotLines: [{
                    value: 0,
                    width: 1,
                    color: '#808080'
                }]
            },
            tooltip: {
                valueSuffix: ''
            },
            legend: {
                layout: 'vertical',
                align: 'right',
                verticalAlign: 'middle',
                borderWidth: 0
            },
            series: [{
                name: 'Count',
                //data: [7.0, 6.9, 9.5, 14.5, 18.2, 21.5, 25.2, 26.5, 23.3, 18.3, 13.9, 9.6]
               
                
                 data: [
                	[Date.UTC(2010,01,01), 120],
                	[Date.UTC(2010,02,02), 71.5],
                	[Date.UTC(2010,04,03), 106.4],
                	[Date.UTC(2010,08,06), 129.2],
                	[Date.UTC(2010,11,07), 144.0],
                	[Date.UTC(2010,12,08), 176.0]
                ] // end data
                
            }]
        });// end highcharts

	}); // end $(window).load(function() {
}); // end $(document).ready(function(){
//#########################################################################	
</script>
  
	</head>

  	<body>
  	
    	<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      		<div class="container">
        		<div class="navbar-header">
          			<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            			<span class="sr-only">Toggle navigation</span>
            			<span class="icon-bar"></span>
            			<span class="icon-bar"></span>
            			<span class="icon-bar"></span>
          			</button>
          
          			<a class="navbar-brand" href="index.html">Data Visualization</a>
        		</div>
        		
        		<div class="collapse navbar-collapse">
          			<ul class="nav navbar-nav">
          			<li><a href="index.html">Home</a></li>
          			<li><a href="about.html">About</a></li>       
          			</ul>
        		</div><!--/.nav-collapse -->
      		</div><!-- /.container -->
    	</div><!--/.navbar -->
  	
    	<div class="container">
      		<br>
       		<p>
       			<a class="btn btn-success btn-lg" role="button" href="index.html" >&laquo; Back to see more</a>
       			<font color=red>Under Construction. Data points on Line Graph below are hardcoded as an example of this type data representation.</font>
       			<div id="status_message"></div>
       		</p>
      		
			<div id="progress" class="progress">
				<div id="progress-bar" class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;"></div> 
			</div>
       		<div id="flickr_count"></div>
     
   			<div class="well">
   				<p>
   					<div id="chart1" style="height:100%; width:100%;"></div> 
   					<sub>
   				 	* Obama elected: November 4, 2008<br>
   				 	* Sworn into office: January 20, 2009
   				 	</sub>
   				</p>
   			</div><!--/.well -->

      		<hr>

      		<footer>
        		<p>&copy; SweetCodeSolutions 2014</p>
      		</footer>
    	</div> <!-- /container -->
  	
    	<!-- Bootstrap core JavaScript
    	================================================== -->
    	<!-- Placed at the end of the document so the pages load faster -->
  
    	<script src="js/bootstrap.min.js"></script>
  	</body>
</html>